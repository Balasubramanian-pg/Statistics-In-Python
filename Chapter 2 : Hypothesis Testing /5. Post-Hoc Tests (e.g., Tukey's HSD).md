### **Post-Hoc Tests (e.g., Tukey's HSD)**

**Post-hoc tests** are used after an **ANOVA** to determine **which specific groups** differ from each other when the ANOVA result is significant. They control the **family-wise error rate** (the probability of making at least one Type I error when performing multiple comparisons).

---

### **When to Use Post-Hoc Tests**
- After a **significant ANOVA result** (p < 0.05).
- To identify **which pairs of groups** have significantly different means.
- When you have **three or more groups** and want to avoid inflated Type I errors from multiple t-tests.

---

### **Common Post-Hoc Tests**
1. **Tukey’s HSD (Honestly Significant Difference)**
   - Compares **all possible pairs** of group means.
   - Controls the **family-wise error rate**.
   - Assumes **equal sample sizes** and **homogeneity of variance**.
   - Works well for **balanced designs**.

2. **Bonferroni Correction**
   - Adjusts the **significance level** for each comparison (e.g., 0.05 divided by the number of comparisons).
   - More **conservative** than Tukey’s HSD.
   - Works for **unequal sample sizes**.

3. **Scheffé’s Test**
   - Very **conservative** and robust to **unequal variances**.
   - Useful for **complex comparisons** (e.g., interactions in two-way ANOVA).

4. **Dunnett’s Test**
   - Compares **all groups to a single control group**.
   - Useful in **experimental designs** with a control condition.

5. **Games-Howell Test**
   - Used when **homogeneity of variance is violated**.
   - Adjusts for **unequal variances**.

---

### **Tukey’s HSD: How It Works**
1. **Calculate the HSD value**:
   \[
   HSD = q \times \sqrt{\frac{MSW}{n}}
   \]
   - \( q \): Studentized range statistic (from Tukey’s table).
   - \( MSW \): Mean square within (from ANOVA).
   - \( n \): Number of observations per group.

2. **Compare the difference** between each pair of group means to the HSD value.
   - If the difference > HSD, the means are **significantly different**.

---

### **Example**
Suppose an ANOVA shows a significant difference among three groups (A, B, C):

| Group | Mean | n  |
|-------|------|----|
| A     | 85   | 10 |
| B     | 90   | 10 |
| C     | 78   | 10 |

- **MSW (Mean Square Within)**: 20 (from ANOVA).
- **q-value** (for 3 groups, df = 27): ~3.5 (from Tukey’s table).
- **HSD**:
  \[
  HSD = 3.5 \times \sqrt{\frac{20}{10}} = 3.5 \times 1.41 \approx 4.95
  \]

- **Compare differences**:
  - A vs. B: \( |85 - 90| = 5 \) > 4.95 → **Significant**.
  - A vs. C: \( |85 - 78| = 7 \) > 4.95 → **Significant**.
  - B vs. C: \( |90 - 78| = 12 \) > 4.95 → **Significant**.

---

### **How to Perform Post-Hoc Tests in Software**
- **Python**: Use `statsmodels` or `scipy` with `pairwise_tukeyhsd`.
- **R**: Use `TukeyHSD()` after `aov()`.
- **SPSS**: Select **Post-Hoc Tests** in the ANOVA menu.

---

### **Key Considerations**
- **Equal Variances**: Use Tukey’s HSD or Bonferroni.
- **Unequal Variances**: Use Games-Howell.
- **Control Group**: Use Dunnett’s test.
- **Large Number of Groups**: Consider **false discovery rate (FDR)** corrections.
